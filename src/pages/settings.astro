---
import Layout from "../layouts/Layout.astro";
import { AccountSettings } from "../components/AccountSettings";
import { AuthenticatedNavbar } from "../components/AuthenticatedNavbar";

// Auth guard - middleware already handles redirect to /login if not authenticated
const user = Astro.locals.user;

if (!user) {
  return Astro.redirect("/login?redirect=/settings");
}

// Prepare user object for components
const authUser = {
  id: user.id,
  email: user.email ?? "",
};
---

<Layout title="Ustawienia konta">
  <AuthenticatedNavbar client:load user={authUser} />
  <AccountSettings client:load user={authUser} />
</Layout>
