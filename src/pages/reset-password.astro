---
import Layout from "../layouts/Layout.astro";
import { ResetPasswordForm } from "../components/ResetPasswordForm";
import { ThemeToggle } from "../components/ThemeToggle";

// Sprawdzenie czy jest access_token w URL (tryb update hasła)
const url = new URL(Astro.request.url);
const accessToken = url.searchParams.get('access_token') || url.hash.match(/access_token=([^&]*)/)?.[1];
const type = url.searchParams.get('type') || url.hash.match(/type=([^&]*)/)?.[1];

const mode = (accessToken && type === 'recovery') ? 'update' : 'request';
---

<Layout title="Reset hasła">
  <ThemeToggle client:load />
  <ResetPasswordForm client:load mode={mode} accessToken={accessToken || undefined} />
</Layout>
