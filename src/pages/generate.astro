---
import Layout from "../layouts/Layout.astro";
import { FlashcardGenerationView } from "../components/FlashcardGenerationView";
import { AuthenticatedNavbar } from "../components/AuthenticatedNavbar";

// Auth guard - middleware already handles redirect to /login if not authenticated
// But we double-check here for safety
const user = Astro.locals.user;

if (!user) {
  return Astro.redirect("/login?redirect=/generate");
}

// Prepare user object for components
const authUser = {
  id: user.id,
  email: user.email ?? "",
};
---

<Layout title="Generowanie Fiszek">
  <AuthenticatedNavbar client:load user={authUser} />
  <FlashcardGenerationView client:load />
</Layout>
